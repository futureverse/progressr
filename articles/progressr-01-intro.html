<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>progressr: An Introduction • progressr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="progressr: An Introduction">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-SB3EQSD9FR"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SB3EQSD9FR');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">progressr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.16.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/progressr-01-intro.html">progressr: An Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/progressr-11-handlers.html">progressr: Customize How Progress is Reported</a></li>
    <li><a class="dropdown-item" href="../articles/progressr-21-map-reduce.html">progressr: Map-Reduce Calls, e.g. lapply() and map()</a></li>
    <li><a class="dropdown-item" href="../articles/progressr-22-parallel-processing.html">progressr: Parallel and Distributed Processing</a></li>
    <li><a class="dropdown-item" href="../articles/progressr-25-replace-cli-with-progressr.html">progressr: Replace 'cli' Progress Bars with 'progressr'</a></li>
    <li><a class="dropdown-item" href="../articles/progressr-29-debug.html">progressr: Debug</a></li>
    <li><a class="dropdown-item" href="../articles/progressr-31-knitr.html">progressr: Render 'knitr' Documents</a></li>
    <li><a class="dropdown-item" href="../articles/progressr-91-appendix.html">progressr: Appendix</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.futureverse.org/"><span class="fa fas fa-home"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-packages">
<li><a class="external-link dropdown-item" href="https://doFuture.futureverse.org">doFuture (map-reduce)</a></li>
    <li><a class="external-link dropdown-item" href="https://furrr.futureverse.org">furrr (map-reduce)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.futureverse.org">future</a></li>
    <li><a class="external-link dropdown-item" href="https://future.apply.futureverse.org">future.apply (map-reduce)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.batchtools.futureverse.org">future.batchtools (backend)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.callr.futureverse.org">future.callr (backend)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.mirai.futureverse.org">future.mirai (backend)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.tests.futureverse.org">future.tests</a></li>
    <li><a class="external-link dropdown-item" href="https://globals.futureverse.org">globals</a></li>
    <li><a class="external-link dropdown-item" href="https://listenv.futureverse.org">listenv</a></li>
    <li><a class="external-link dropdown-item" href="https://parallelly.futureverse.org">parallelly</a></li>
    <li><a class="dropdown-item" href="https://progressr.futureverse.org">progressr</a></li>
    <li><a class="external-link dropdown-item" href="https://BiocParallel.FutureParam.futureverse.org">BiocParallel.FutureParam (experimental)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.tools.futureverse.org">future.tools (experimental)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.mapreduce.futureverse.org">future.mapreduce (experimental)</a></li>
    <li><a class="external-link dropdown-item" href="https://marshal.futureverse.org">marshal (experimental)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://cloud.r-project.org/package=progressr"><span class="fa fab fa-r-project"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/futureverse/progressr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>progressr: An Introduction</h1>
                        <h4 data-toc-skip class="author">Henrik
Bengtsson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/futureverse/progressr/blob/HEAD/vignettes/progressr-01-intro.md" class="external-link"><code>vignettes/progressr-01-intro.md</code></a></small>
      <div class="d-none name"><code>progressr-01-intro.Rmd</code></div>
    </div>

    
    
<!--
%\VignetteIndexEntry{progressr: An Introduction}
%\VignetteAuthor{Henrik Bengtsson}
%\VignetteKeyword{R}
%\VignetteKeyword{package}
%\VignetteKeyword{vignette}
%\VignetteKeyword{Rprofile}
%\VignetteKeyword{Renviron}
%\VignetteEngine{progressr::selfonly}
-->
<!-- DO NOT EDIT THIS FILE! Edit 'OVERVIEW.md' instead and then rebuild this file with 'make vignettes' -->
<p>The <strong><a href="https://progressr.futureverse.org">progressr</a></strong> package
provides a minimal API for reporting progress updates in <a href="https://www.r-project.org/" class="external-link">R</a>. The design is to separate the
representation of progress updates from how they are presented. What
type of progress to signal is controlled by the developer. How these
progress updates are rendered is controlled by the end user. For
instance, some users may prefer visual feedback such as a horizontal
progress bar in the terminal, whereas others may prefer auditory
feedback. The <strong><a href="https://progressr.futureverse.org">progressr</a></strong>
framework is designed to work out-of-the-box also with parallel and
distributed processing, especially with the <strong><a href="https://www.futureverse.org" class="external-link">futureverse</a></strong>
ecosystem.</p>
<p><img src="imgs/three_in_chinese.gif" alt="Three strokes writing three in Chinese" style="float: right; margin-right: 1ex; margin-left: 1ex;"></p>
<p>Design motto:</p>
<blockquote>
<p>The developer is responsible for providing progress updates but it’s
only the end user who decides if, when, and how progress should be
presented. No exceptions will be allowed.</p>
</blockquote>
<div class="section level2">
<h2 id="two-minimal-apis---one-for-developers-and-one-for-end-users">Two Minimal APIs - One For Developers and One For End-Users<a class="anchor" aria-label="anchor" href="#two-minimal-apis---one-for-developers-and-one-for-end-users"></a>
</h2>
<div style="overflow: hidden">
<div style="float: left">
<table style="border: 1px solid #999; box-shadow: 2px 2px 2px #999;" class="table">
<tr>
<th>
Developer’s API
</th>
</tr>
<tr style="vertical-align: top">
<td>
<p>
</p>
<ol style="list-style-type: decimal">
<li>Set up a progressor with a certain number of steps:</li>
</ol>
<pre>
p &lt;- progressor(nsteps)
p &lt;- progressor(along = x)
</pre>
<p>
</p>
<ol start="2" style="list-style-type: decimal">
<li>Signal progress:</li>
</ol>
<pre>
p()               # one-step progress
p(amount = 0)     # "still alive"
p("loading ...")  # pass on a message
</pre>
</td>
</tr>
</table>
</div>
<div style="float: left">
    
</div>
<div style="float: left">
<table style="border: 1px solid #999; box-shadow: 2px 2px 2px #999;" class="table">
<tr>
<th>
End-user’s API
</th>
</tr>
<tr style="vertical-align: top">
<td>
<p>
1a. Subscribe to progress updates from everywhere:
</p>
<pre>
handlers(global = TRUE)

y &lt;- slow_sum(1:5)
y &lt;- slow_sum(6:10)
</pre>
<p>
1b. Subscribe to a specific expression:
</p>
<pre>
with_progress({
  y &lt;- slow_sum(1:5)
  y &lt;- slow_sum(6:10)
})
</pre>
<p>
</p>
<ol start="2" style="list-style-type: decimal">
<li>Configure how progress is presented:</li>
</ol>
<pre>
handlers("progress")
handlers("txtprogressbar", "beepr")
handlers(handler_pbcol(enable_after = 3.0))
handlers(handler_progress(complete = "#"))
</pre>
</td>
</tr>
</table>
</div>
</div>
<div class="section level2">
<h2 id="a-simple-example">A simple example<a class="anchor" aria-label="anchor" href="#a-simple-example"></a>
</h2>
<p>Assume that we have a function <code><a href="../reference/slow_sum.html">slow_sum()</a></code> for adding up
the values in a vector. It is so slow, that we like to provide progress
updates to whoever might be interested in it. With the
<strong>progressr</strong> package, this can be done as:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slow_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">sum</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">kk</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="va">sum</span> <span class="op">&lt;-</span> <span class="va">sum</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="va">kk</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span>message <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Adding %g"</span>, <span class="va">x</span><span class="op">[</span><span class="va">kk</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">sum</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Note how there are <em>no</em> arguments
(e.g. <code>.progress = TRUE</code>) in the code that specify how
progress is presented. This is by design and because the only task for
the developer is to decide on where in the code it makes sense to signal
that progress has been made. As we will see next, it should be up to the
end user, and end user only, of this code to decide whether they want to
receive progress updates or not, and, if so, in what format. Asking them
to specify a special “progress” argument adds a lot of friction, it
clutters up the code, and, importantly, might not even be possible for
end users to do (e.g. they call a package function that in turn calls
the progress reporting function of interest).</p>
<p>Now, if we call this function, without further settings:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">slow_sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="sc">&gt;</span> y</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">55</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="sc">&gt;</span></span></code></pre></div>
<p>the default is that there will be <em>no</em> progress updates. To
get progress updates, we need to request them to be “handled”, which we
do by:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="sc">&gt;</span> progressr<span class="sc">::</span><span class="fu">handlers</span>(<span class="at">global =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>After this, progress will be reported;</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">slow_sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="sc">|</span><span class="er">====================</span>                               <span class="er">|</span>  <span class="dv">40</span>%</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">slow_sum</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="sc">|</span><span class="er">========================================</span>           <span class="er">|</span>  <span class="dv">80</span>%</span></code></pre></div>
<p>To disable reporting again, do:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">handlers</span>(<span class="at">global =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="customizing-how-progress-is-reported">Customizing how progress is reported<a class="anchor" aria-label="anchor" href="#customizing-how-progress-is-reported"></a>
</h2>
<p>By default, <strong><a href="https://progressr.futureverse.org">progressr</a></strong> presents
progress via the built-in <code><a href="https://rdrr.io/r/utils/txtProgressBar.html" class="external-link">utils::txtProgressBar()</a></code>. It
presents itself as a rudimentary ASCII-based horizontal progress bar in
the R terminal. See <code><a href="../reference/handler_txtprogressbar.html">help("handler_txtprogressbar")</a></code> for how
to customize the look of “txtprogressbar”, e.g. colorization and
Unicode. There are many other ways to report on progress, including
visually, auditory, and via notification systems. You can also use a mix
of these, e.g.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/handlers.html">handlers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cli"</span>, <span class="st">"beepr"</span>, <span class="st">"ntfy"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>See the ‘Customizing How Progress is Reported’ vignette for for
examples.</p>
</div>
<div class="section level2">
<h2 id="additional-features">Additional Features<a class="anchor" aria-label="anchor" href="#additional-features"></a>
</h2>
<div class="section level3">
<h3 id="support-for-progressr-elsewhere">Support for progressr elsewhere<a class="anchor" aria-label="anchor" href="#support-for-progressr-elsewhere"></a>
</h3>
<p>Note that progression updates by <strong>progressr</strong> is
designed to work out of the box for any iterator framework in R. See the
different package vignettes for details. Prominent examples are:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> etc. of base R</li>
<li>
<code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map()</a></code> etc. by the <strong><a href="https://cran.r-project.org/package=purrr" class="external-link">purrr</a></strong>
package</li>
<li>
<code><a href="https://rdrr.io/pkg/plyr/man/llply.html" class="external-link">llply()</a></code> etc. by the <strong><a href="https://cran.r-project.org/package=plyr" class="external-link">plyr</a></strong>
package</li>
<li>
<code><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach()</a></code> iterations by the <strong><a href="https://cran.r-project.org/package=foreach" class="external-link">foreach</a></strong>
package</li>
</ul>
<p>and near-live progress reporting in parallel and distributed
processing via the <strong><a href="https://future.futureverse.org" class="external-link">future</a></strong> framework:</p>
<ul>
<li>
<code><a href="https://future.apply.futureverse.org/reference/future_lapply.html" class="external-link">future_lapply()</a></code> etc. by the <strong><a href="https://future.apply.futureverse.org" class="external-link">future.apply</a></strong>
package</li>
<li>
<code><a href="https://furrr.futureverse.org/reference/future_map.html" class="external-link">future_map()</a></code> etc. by the <strong><a href="https://furrr.futureverse.org" class="external-link">furrr</a></strong> package</li>
<li>
<code><a href="https://rdrr.io/pkg/plyr/man/llply.html" class="external-link">llply()</a></code> etc. by the <strong><a href="https://cran.r-project.org/package=plyr" class="external-link">plyr</a></strong> and
<strong><a href="https://doFuture.futureverse.org" class="external-link">doFuture</a></strong>
packages</li>
<li>
<code><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach()</a></code> iterations via the <strong>foreach</strong>
and <strong><a href="https://doFuture.futureverse.org" class="external-link">doFuture</a></strong>
packages</li>
<li>
<code><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply()</a></code> etc. by the <strong><a href="https://www.bioconductor.org/packages/BiocParallel/" class="external-link">BiocParallel</a></strong>
and <strong><a href="https://doFuture.futureverse.org" class="external-link">doFuture</a></strong>
packages</li>
</ul>
<p>Other uses of <strong>progressr</strong> are:</p>
<ul>
<li>make packages that report progress via the <strong><a href="https://cran.r-project.org/package=cli" class="external-link">cli</a></strong> package
(e.g. <strong>purrr</strong>) report progress via
<strong>progressr</strong>
</li>
<li>make <code>knit()</code> of the <strong><a href="https://cran.r-project.org/package=knitr" class="external-link">knitr</a></strong>
package report via <strong>progressr</strong>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="use-regular-output-as-usual-alongside-progress-updates">Use regular output as usual alongside progress updates<a class="anchor" aria-label="anchor" href="#use-regular-output-as-usual-alongside-progress-updates"></a>
</h3>
<p>In contrast to other progress-bar frameworks, output from
<code><a href="https://rdrr.io/r/base/message.html" class="external-link">message()</a></code>, <code><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat()</a></code>, <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> and so
on, will <em>not</em> interfere with progress reported via
<strong>progressr</strong>. For example, say we have:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slow_sqrt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">xs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Calculating the square root of "</span>, <span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"x=%g"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>we will get:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(progressr)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">handlers</span>(<span class="at">global =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">handlers</span>(<span class="st">"progress"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">slow_sqrt</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>Calculating the square root of <span class="dv">1</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>Calculating the square root of <span class="dv">2</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="sc">-</span> [<span class="sc">==</span><span class="er">=========&gt;</span><span class="sc">-----------------------------------</span>]  <span class="dv">25</span>% x<span class="ot">=</span><span class="dv">2</span></span></code></pre></div>
<p>This works because <strong>progressr</strong> will briefly buffer any
output internally and only release it when the next progress update is
received just before the progress is re-rendered in the terminal. This
is why you see a two second delay when running the above example. Note
that, if we use progress handlers that do not output to the terminal,
such as <code>handlers("beepr")</code>, then output does not have to be
buffered and will appear immediately.</p>
<p><em>Comment</em>: When signaling a warning using
<code>warning(msg, immediate. = TRUE)</code> the message is immediately
outputted to the standard-error stream. However, this is not possible to
emulate when warnings are intercepted using calling handlers. This is a
limitation of R that cannot be worked around. Because of this, the above
call will behave the same as <code>warning(msg)</code> - that is, all
warnings will be buffered by R internally and released only when all
computations are done.</p>
</div>
<div class="section level3">
<h3 id="sticky-messages">Sticky messages<a class="anchor" aria-label="anchor" href="#sticky-messages"></a>
</h3>
<p>As seen above, some progress handlers present the progress message as
part of its output, e.g. the “progress” handler will display the message
as part of the progress bar. It is also possible to “push” the message
up together with other terminal output. This can be done by adding class
attribute <code>"sticky"</code> to the progression signaled. This works
for several progress handlers that output to the terminal. For example,
with:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slow_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="../reference/progressor.html">progressor</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">sum</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">kk</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="va">sum</span> <span class="op">&lt;-</span> <span class="va">sum</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="va">kk</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Step %d"</span>, <span class="va">kk</span><span class="op">)</span>, class <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">kk</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">5</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="st">"sticky"</span>, amount <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span>message <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Adding %g"</span>, <span class="va">x</span><span class="op">[</span><span class="va">kk</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">sum</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>we get</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">handlers</span>(<span class="st">"txtprogressbar"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">slow_sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>Step <span class="dv">5</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>Step <span class="dv">10</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="sc">|</span><span class="er">====================</span>                               <span class="er">|</span>  <span class="dv">43</span>%</span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">handlers</span>(<span class="st">"progress"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="sc">&gt;</span> y <span class="ot">&lt;-</span> <span class="fu">slow_sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>Step <span class="dv">5</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>Step <span class="dv">10</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="sc">/</span> [<span class="sc">==</span><span class="er">=============&gt;</span><span class="sc">-------------------------</span>]  <span class="dv">43</span>% Adding <span class="dv">13</span></span></code></pre></div>
</div>
</div>
</div>
</main>
</div>
</div>
  <aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside><footer><div class="pkgdown-footer-left">
  <p>Developed by Henrik Bengtsson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3</p> and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9007.</p>
</div>

    </footer>
</body>
</html>
